<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Canvas Example</title>
</head>
<body style="background-color: #202020">
	<canvas 
		id="myCanvas" 
		style="image-rendering: pixelated;margin:50px;background-color:white"
	>
	</canvas>
	<script>
		var canvas = document.getElementById('myCanvas')
		var ctx = canvas.getContext('2d')

		async function renderQrCode() {
			const response = await fetch("http://localhost:8080/coordinates")
			const { coordinates, pixels }= await response.json()
			canvas.width = pixels * 10
			canvas.height = pixels * 10
			canvas.style.padding = `${4 * 10}px`
			console.log("ass")

			for (var i = 0; i < coordinates.length; i++) {
				if (!coordinates[i].reserved) {
					continue
				}
				ctx.fillStyle = coordinates[i].color
				ctx.fillRect(coordinates[i].x*10, coordinates[i].y*10, 10, 10)

			}

			for (var i = 0; i < coordinates.length; i++) {
				if (coordinates[i].reserved) {
					continue
				}
				ctx.fillStyle = coordinates[i].color
				ctx.fillRect(coordinates[i].x*10, coordinates[i].y*10, 10, 10)
				await new Promise(resolve => setTimeout(resolve, 10));
			}
		}

		renderQrCode()
	</script>
</body>
</html>
